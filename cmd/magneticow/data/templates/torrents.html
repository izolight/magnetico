<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{% if .Search %}"{{ .Search}}"{% else %}Most recent torrents{% endif %} - magneticow</title>
    <link rel="stylesheet" href="static/styles/reset.css">
    <link rel="stylesheet" href="static/styles/essential.css">
    <link rel="stylesheet" href="static/styles/torrents.css">
    <!-- <script src="script.js"></script> -->
</head>
<body>
<header>
    <div><a href="/"><b>magnetico<sup>w</sup></b></a>&#8203;<sub>(pre-alpha)</sub></div>
    <form action="/torrents" method="get" autocomplete="off" role="search">
        <input type="search" name="search" placeholder="Search the BitTorrent DHT" value="{{ .Search }}">
    </form>
    <div>
        <a href="{{ .SubscriptionURL }}"><img src="static/assets/feed.png"
                                              alt="feed icon" title="subscribe" /> subscribe</a>
    </div>
</header>
<main>
    <table>
        <thead>
            <tr>
                <th><!-- Magnet link --></th>
                <th>
                {% if .SortedBy == "name ASC" %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=name+DESC">Name ▲</a>
                {% elif .SortedBy == "name DESC" %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=name+ASC">Name ▼</a>
                {% else %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=name+ASC">Name</a>
                {% endif %}
                </th>
                <th>
                {% if .SortedBy == "total_size ASC" %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=total_size+DESC">Size ▲</a>
                {% elif .SortedBy == "total_size DESC" %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=total_size+ASC">Size ▼</a>
                {% else %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=total_size+ASC">Size</a>
                {% endif %}
                </th>
                <th>
                {% if SortedBy == "discovered_on ASC" %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=discovered_on+DESC">Discovered on ▲</a>
                {% elif .SortedBy == "discovered_on DESC" %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=discovered_on+ASC">Discovered on ▼</a>
                {% else %}
                    <a href="/torrents/?search={{ .Search }}&sort_by=discovered_on+DESC">Discovered on</a>
                {% endif %}
                </th>
            </tr>
        </thead>
        <tbody>
        {% range .Torrents %}
            <tr>
                <td><a href="magnet:?xt=urn:btih:{{ .info_hash }}&dn={{ .name }}">
                    <img src="static/assets/magnet.gif') }}" alt="Magnet link"
                         title="Download this torrent using magnet" /></a></td>
                <td><a href="/torrents/{{ .info_hash }}/{{ .name }}">{{ .name }}</a></td>
                <td>{{ .size }}</td>
                <td>{{ .discovered_on }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</main>
<footer>

    <form action="/torrents" method="get">
        <button {% if page == 0 %}disabled{% endif %}>Previous</button>
        <input type="text" name="search" value="{{ .Search }}" hidden>
    {% if sorted_by %}
        <input type="text" name="sort_by" value="{{ .SortedBy }}" hidden>
    {% endif %}
        <input type="number" name="page" value="{{ .After }}" hidden>
    </form>
    <form action="/torrents" method="get">
        <button {% if not next_page_exists %}disabled{% endif %}>Next</button>
        <input type="text" name="search" value="{{ .Search }}" hidden>
    {% if sorted_by %}
        <input type="text" name="sort_by" value="{{ .SortedBy }}" hidden>
    {% endif %}
        <input type="number" name="page" value="{{ .Before }}" hidden>
    </form>
</footer>
</body>
</html>
